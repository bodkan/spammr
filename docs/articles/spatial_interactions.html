<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spatial interaction dynamics • slendr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spatial interaction dynamics">
<meta property="og:description" content="slendr">
<meta property="og:image" content="https://bodkan.net/slendr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">slendr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/slendr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/spatial_interactions.html">Spatial interaction dynamics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bodkan/slendr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="spatial_interactions_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spatial interaction dynamics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bodkan/slendr/blob/master/vignettes/spatial_interactions.Rmd"><code>vignettes/spatial_interactions.Rmd</code></a></small>
      <div class="hidden name"><code>spatial_interactions.Rmd</code></div>

    </div>

    
    
<pre><code>#&gt; ℹ Loading slendr</code></pre>
<p>In addition to builing models that capture spatial dynamics such as movement (displacement) or expansion conveniently using a set of <a href="../reference/index.html#section-population-dynamics">simple R functions</a> which do the work worth of hundreds of lines of Eidos code for you, <em>slendr</em> makes it possible to tweak more subtle characteristics of spatial population genetic models.</p>
<p>Among such characteristics are so called spatial interactions, described in a very detailed way in chapter 15 of SLiM’s <a href="http://benhaller.com/slim/SLiM_Manual.pdf">extensive manual</a>. Again, describing SLiM’s functionality in detail is very much beyond the scope of <em>slendr</em>’s tutorial vignettes such as this one. However, broadly speaking, <em>slendr</em> implements three different kinds of spatial interactions or dispersal parameters:</p>
<ol style="list-style-type: decimal">
<li>
<em>Spatial competition distance</em> - governed by <em>slendr</em> parameter <code>competition_dist</code> which signifies the maximum distance at which two individuals can influence each other’s fitness via competition.</li>
<li>
<em>Mate choice</em> <em>distance</em> - governed by the parameter <code>mate_dist</code>, determining how far does an individual pick a potential mate.</li>
<li>
<em>Dispersal distance</em> - determined by the parameter <code>dispersal_dist</code> which establishes how far from a parent can offspring migrate until the next generation (when it can potentially become a parent itself). More accurately, this parameter determines the standard deviation of a normal distribution of such dispersal distances.</li>
</ol>
<p>All three parameters can be specified for each simulated population individually. Alternatively, default values for these parameters can be given in a <code><a href="../reference/compile.html">compile()</a></code> call. Importantly, a population must be given the values of all three of these parameters, be it specific values for that particular population or a default value during compilation.</p>
<p>Finally, as with other functions for programming model spatial dynamics, the <em>slendr</em> package provides a simple way to program the spatial interaction dynamics throughout the course of the simulation. Even complex models can be programmed using only a couple of lines of extremely simple R code, resulting in a robust SLiM simulation script being generated under the hood.</p>
<p>To demonstrate this feature, let’s look at a simple example. We will focus only on programming spatial interaction dynamics and will leave many other functions that we covered in the extensive <a href="slendr.html">tutorial vignette</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bodkan/slendr">slendr</a></span><span class="op">)</span></code></pre></div>
<p>Here is a single population <em>pop</em> which occupies a square, blank landscape 100 distance units on each side. The population has a circular range, appears at time 1 (this model will be specified in forward time direction) and has a size of 3000 individuals.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">blank_world</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/world.html">world</a></span><span class="op">(</span>
  xrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,
  yrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,
  landscape <span class="op">=</span> <span class="st">"blank"</span>
<span class="op">)</span>

<span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/population.html">population</a></span><span class="op">(</span>
  name <span class="op">=</span> <span class="st">"pop"</span>, time <span class="op">=</span> <span class="fl">1</span>, N <span class="op">=</span> <span class="fl">3000</span>,
  map <span class="op">=</span> <span class="va">blank_world</span>, center <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>, radius <span class="op">=</span> <span class="fl">50</span>,
  competition_dist <span class="op">=</span> <span class="fl">5</span>, mate_dist <span class="op">=</span> <span class="fl">5</span>, dispersal_dist <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span></code></pre></div>
<p><img src="spatial_interactions_files/figure-html/abstract_world-1.png" width="480"></p>
<p>Note that we also specified the values of each of the three spatial parameters. They are given in distance units corresponding to the coordinate reference system of the underlying world map (i.e. the world map is 100 distance units wide and 100 distance units tall).</p>
<p>Next, we will program a series of five changes in the competition distance parameter of this population. To do this, we will use the fact that most of <em>slendr</em>’s functions implement a tidyverse pipe-friendly interface, which makes model specification code very concise and readable.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pop</span> <span class="op">&lt;-</span> <span class="va">pop</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">100</span>, competition_dist <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">200</span>, competition_dist <span class="op">=</span> <span class="fl">40</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">300</span>, competition_dist <span class="op">=</span> <span class="fl">60</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">400</span>, competition_dist <span class="op">=</span> <span class="fl">80</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">500</span>, competition_dist <span class="op">=</span> <span class="fl">100</span>, dispersal_dist <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p>Finally, we will compile this model and execute the simulation. Note that because we are working with a forward time model, we need to specify the total length of the simulation to know when to terminate it. Also, we specify a short burnin to let the initial spatial distribution settle down based on the initial spatial interaction distances. We will save the spatial locations of all individuals in order to visualize the spatial population dynamics with an animation later.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile.html">compile</a></span><span class="op">(</span>populations <span class="op">=</span> <span class="va">pop</span>, generation_time <span class="op">=</span> <span class="fl">1</span>, resolution <span class="op">=</span> <span class="fl">1</span>,
                 dir <span class="op">=</span> <span class="st">"/tmp/spatial-interactions/"</span>, sim_length <span class="op">=</span> <span class="fl">800</span><span class="op">)</span>

<span class="fu"><a href="../reference/slim.html">slim</a></span><span class="op">(</span><span class="va">model</span>, burnin <span class="op">=</span> <span class="fl">300</span>, seq_length <span class="op">=</span> <span class="fl">1</span>, recomb_rate <span class="op">=</span> <span class="fl">0</span>,
     save_locations <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"batch"</span><span class="op">)</span></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Martin Petr.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
